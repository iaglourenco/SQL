--PROJETO DE SQL 
--IAGO LOURENÃ‡O 15610116

--CRIACAO DAS TABELAS REQUERIDAS
CREATE TABLE ALUNOS (RA NUMBER,NOME VARCHAR2(20),DATA_NASC DATE,NUM_CURSO NUMBER);

CREATE TABLE ALUNOS_GRAD (CD NUMBER,RA NUMBER);
CREATE TABLE ALUNOS_POS (ORIENTADOR VARCHAR2(20),RA NUMBER);

CREATE TABLE CURSAM (RA NUMBER,COD_DISC NUMBER,FREQ NUMBER);
CREATE TABLE CURSARAM (RA NUMBER,COD_DISC NUMBER,SEMESTRE NUMBER,NOTA NUMBER,FREQ NUMBER,STATUS CHAR);

CREATE TABLE DISCIPLINAS (COD NUMBER,NOME VARCHAR2(30),CRED NUMBER);

CREATE TABLE PRE_REQ (COD_DISC NUMBER,COD_PRE_REQ NUMBER);

CREATE TABLE GRADE (COD_DISC NUMBER,NUM_CURSO NUMBER);

CREATE TABLE CURSOS (NUM NUMBER,NOME VARCHAR2(30));

--DEFINICAO DAS CONSTRAINTS NECESSARIAS

ALTER TABLE ALUNOS ADD CONSTRAINT PK_ALUNOS PRIMARY KEY(RA);
ALTER TABLE ALUNOS_GRAD ADD CONSTRAINT PK_ALUNOS_GRAD PRIMARY KEY  (RA);
ALTER TABLE ALUNOS_POS ADD CONSTRAINT PK_ALUNOS_POS PRIMARY KEY (RA); 
ALTER TABLE DISCIPLINAS ADD CONSTRAINT PK_DISCIPLINAS PRIMARY KEY (COD);
ALTER TABLE CURSOS ADD CONSTRAINT PK_CURSOS PRIMARY KEY (NUM);

ALTER TABLE ALUNOS ADD CONSTRAINT FK_ALUNOS FOREIGN KEY (NUM_CURSO) REFERENCES CURSOS;
ALTER TABLE ALUNOS_GRAD ADD CONSTRAINT FK_ALUNOS_GRAD FOREIGN KEY (RA) REFERENCES ALUNOS;
ALTER TABLE ALUNOS_POS ADD CONSTRAINT FK_ALUNOS_POS FOREIGN KEY (RA) REFERENCES ALUNOS; 

ALTER TABLE CURSAM ADD CONSTRAINT PK_CURSAM_RA PRIMARY KEY (RA,COD_DISC);
ALTER TABLE CURSAM ADD CONSTRAINT FK_CURSAM_RA FOREIGN KEY (RA) REFERENCES ALUNOS;
ALTER TABLE CURSAM ADD CONSTRAINT FK_CURSAM_COD_DISC FOREIGN KEY (COD_DISC) REFERENCES DISCIPLINAS;

ALTER TABLE CURSARAM ADD CONSTRAINT PK_CURSARAM_RA PRIMARY KEY (RA,COD_DISC,SEMESTRE);
ALTER TABLE CURSARAM ADD CONSTRAINT FK_CURSARAM_RA FOREIGN KEY (RA) REFERENCES ALUNOS;
ALTER TABLE CURSARAM ADD CONSTRAINT FK_CURSARAM_COD_DISC FOREIGN KEY (COD_DISC) REFERENCES DISCIPLINAS;
ALTER TABLE CURSARAM ADD CONSTRAINT CH_STATUS CHECK (STATUS IN ('A','R')); 

--ALTER TABLE PRE_REQ ADD CONSTRAINT PK_PRE_REQ PRIMARY KEY (COD_PRE_REQ);
ALTER TABLE PRE_REQ ADD CONSTRAINT FK_PRE_REQ_COD_DISC FOREIGN KEY (COD_DISC) REFERENCES DISCIPLINAS;
ALTER TABLE PRE_REQ ADD CONSTRAINT FK_PRE_REQ_COD FOREIGN KEY (COD_PRE_REQ) REFERENCES DISCIPLINAS;

ALTER TABLE GRADE ADD CONSTRAINT FK_GRADE_COD_DISC FOREIGN KEY (COD_DISC) REFERENCES DISCIPLINAS;
ALTER TABLE GRADE ADD CONSTRAINT FK_GRADE_NUM_CURSO FOREIGN KEY (NUM_CURSO) REFERENCES CURSOS;

CREATE SEQUENCE SEQ_NUM_CURSO START WITH 1;
CREATE SEQUENCE SEQ_RA START WITH 19000000;
CREATE SEQUENCE SEQ_COD_DISC START WITH 100;


--INSERTS INICIAIS

INSERT INTO CURSOS VALUES(SEQ_NUM_CURSO.NEXTVAL,'ENGENHARIA DA COMPUTACAO');
INSERT INTO CURSOS VALUES(SEQ_NUM_CURSO.NEXTVAL,'HISTORIA');
INSERT INTO CURSOS VALUES(SEQ_NUM_CURSO.NEXTVAL,'FISICA');
INSERT INTO CURSOS VALUES(SEQ_NUM_CURSO.NEXTVAL,'ADMINISTRACAO');



INSERT INTO DISCIPLINAS VALUES(SEQ_COD_DISC.NEXTVAL,'CALCULO',10);
INSERT INTO DISCIPLINAS VALUES(SEQ_COD_DISC.NEXTVAL,'SISTEMAS OPERACIONAIS',5);
INSERT INTO DISCIPLINAS VALUES(SEQ_COD_DISC.NEXTVAL,'ECONOMIA',3);
INSERT INTO DISCIPLINAS VALUES(SEQ_COD_DISC.NEXTVAL,'DIREITO',4);
INSERT INTO DISCIPLINAS VALUES(SEQ_COD_DISC.NEXTVAL,'TERMODINAMICA',4);
INSERT INTO DISCIPLINAS VALUES(SEQ_COD_DISC.NEXTVAL,'PARADIGMAS',2);
INSERT INTO DISCIPLINAS VALUES(SEQ_COD_DISC.NEXTVAL,'CIRCUITOS',2);
INSERT INTO DISCIPLINAS VALUES(SEQ_COD_DISC.NEXTVAL,'BANCO DE DADOS',5);
INSERT INTO DISCIPLINAS VALUES(SEQ_COD_DISC.NEXTVAL,'MATEMATICA FINANCEIRA',3);
INSERT INTO DISCIPLINAS VALUES(SEQ_COD_DISC.NEXTVAL,'RELATIVIDADE GERAL',7);
INSERT INTO DISCIPLINAS VALUES(SEQ_COD_DISC.NEXTVAL,'FISICA QUANTICA',9);
INSERT INTO DISCIPLINAS VALUES(SEQ_COD_DISC.NEXTVAL,'QUIMICA',6);
INSERT INTO DISCIPLINAS VALUES(SEQ_COD_DISC.NEXTVAL,'PROBABILIDADE',10);
INSERT INTO DISCIPLINAS VALUES(SEQ_COD_DISC.NEXTVAL,'INTRODUCAO A PROGRAMACAO',2);
INSERT INTO DISCIPLINAS VALUES(SEQ_COD_DISC.NEXTVAL,'ALGORITMOS',4);
INSERT INTO DISCIPLINAS VALUES(SEQ_COD_DISC.NEXTVAL,'COMPILADORES',7);
INSERT INTO DISCIPLINAS VALUES(SEQ_COD_DISC.NEXTVAL,'MECANICA',4);
INSERT INTO DISCIPLINAS VALUES(SEQ_COD_DISC.NEXTVAL,'GUERRAS MUNDIAIS',5);
INSERT INTO DISCIPLINAS VALUES(SEQ_COD_DISC.NEXTVAL,'ERA VARGAS',6);
INSERT INTO DISCIPLINAS VALUES(SEQ_COD_DISC.NEXTVAL,'ERA COLLOR',5);
INSERT INTO DISCIPLINAS VALUES(SEQ_COD_DISC.NEXTVAL,'PERIODO CREATACEO',3);
INSERT INTO DISCIPLINAS VALUES(SEQ_COD_DISC.NEXTVAL,'PERIODO TRIASSICO',4);
INSERT INTO DISCIPLINAS VALUES(SEQ_COD_DISC.NEXTVAL,'PERIODO JURASSICO',4);
INSERT INTO DISCIPLINAS VALUES(SEQ_COD_DISC.NEXTVAL,'MICROBIOLOGIA',7);
INSERT INTO DISCIPLINAS VALUES(SEQ_COD_DISC.NEXTVAL,'DIREITOS HUMANOS',3);
INSERT INTO DISCIPLINAS VALUES(SEQ_COD_DISC.NEXTVAL,'CONTABILIDADE',5);
INSERT INTO DISCIPLINAS VALUES(SEQ_COD_DISC.NEXTVAL,'ETICA',3);
INSERT INTO DISCIPLINAS VALUES(SEQ_COD_DISC.NEXTVAL,'FISICA LABORATORIAL',7);
INSERT INTO DISCIPLINAS VALUES(SEQ_COD_DISC.NEXTVAL,'INTELIGENCIA ARTIFICIAL',6);
INSERT INTO DISCIPLINAS VALUES(SEQ_COD_DISC.NEXTVAL,'ROBOTICA',7);

INSERT INTO GRADE VALUES(100,1);
INSERT INTO GRADE VALUES(101,1);
INSERT INTO GRADE VALUES(102,1);
INSERT INTO GRADE VALUES(106,1);
INSERT INTO GRADE VALUES(107,1);
INSERT INTO GRADE VALUES(112,1);
INSERT INTO GRADE VALUES(114,1);

INSERT INTO GRADE VALUES(118,2);
INSERT INTO GRADE VALUES(119,2);
INSERT INTO GRADE VALUES(120,2);
INSERT INTO GRADE VALUES(121.2);
INSERT INTO GRADE VALUES(122,2);
INSERT INTO GRADE VALUES(123,2);
INSERT INTO GRADE VALUES(127,2);

INSERT INTO GRADE VALUES(100,3);
INSERT INTO GRADE VALUES(105,3);
INSERT INTO GRADE VALUES(110,3);
INSERT INTO GRADE VALUES(111,3);
INSERT INTO GRADE VALUES(112,3);
INSERT INTO GRADE VALUES(123,3);
INSERT INTO GRADE VALUES(116,3);

INSERT INTO GRADE VALUES(103,4);
INSERT INTO GRADE VALUES(104,4);
INSERT INTO GRADE VALUES(109,4);
INSERT INTO GRADE VALUES(125,4);
INSERT INTO GRADE VALUES(127,4);
INSERT INTO GRADE VALUES(126,4);
INSERT INTO GRADE VALUES(110,4);

INSERT INTO PRE_REQ VALUES(104,100);
INSERT INTO PRE_REQ VALUES(109,100);
INSERT INTO PRE_REQ VALUES(110,100);
INSERT INTO PRE_REQ VALUES(112,100);
INSERT INTO PRE_REQ VALUES(101,114);
INSERT INTO PRE_REQ VALUES(105,114);
INSERT INTO PRE_REQ VALUES(121,120);
INSERT INTO PRE_REQ VALUES(122,120);
INSERT INTO PRE_REQ VALUES(128,100);
INSERT INTO PRE_REQ VALUES(128,114);
INSERT INTO PRE_REQ VALUES(128,126);
INSERT INTO PRE_REQ VALUES(127,110);
INSERT INTO PRE_REQ VALUES(108,125);
INSERT INTO PRE_REQ VALUES(115,101);
INSERT INTO PRE_REQ VALUES(129,116);

INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'PAULO',TO_DATE('16/12/96','dd/mm/yy'),1);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'MARIANA',TO_DATE('21/11/97','dd/mm/yy'),2);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'PEDRO',TO_DATE('15/08/96','dd/mm/yy'),1);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'CAIO',TO_DATE('24/06/97','dd/mm/yy'),4);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'JULIANA',TO_DATE('14/11/97','dd/mm/yy'),3);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'MARIA',TO_DATE('12/10/95','dd/mm/yy'),2);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'JOAO',TO_DATE('21/09/97','dd/mm/yy'),2);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'LEONARDO',TO_DATE('24/01/97','dd/mm/yy'),4);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'FELIPE',TO_DATE('30/04/97','dd/mm/yy'),2);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'LUCAS',TO_DATE('01/02/99','dd/mm/yy'),4);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'VINICIUS',TO_DATE('13/09/97','dd/mm/yy'),2);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'MURILO',TO_DATE('04/12/97','dd/mm/yy'),1);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'GUSTAVO',TO_DATE('09/11/92','dd/mm/yy'),1);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'HELENA',TO_DATE('10/05/96','dd/mm/yy'),2);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'CARLOS',TO_DATE('11/07/97','dd/mm/yy'),3);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'MARCOS',TO_DATE('16/10/96','dd/mm/yy'),4);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'BEATRIZ',TO_DATE('07/10/97','dd/mm/yy'),1);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'KAREN',TO_DATE('09/04/97','dd/mm/yy'),2);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'JAQUELINE',TO_DATE('06/09/97','dd/mm/yy'),3);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'PAULA',TO_DATE('04/10/97','dd/mm/yy'),2);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'BRUNA',TO_DATE('14/12/97','dd/mm/yy'),1);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'RENAN',TO_DATE('11/11/97','dd/mm/yy'),4);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'VALTER',TO_DATE('12/05/97','dd/mm/yy'),3);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'MATEUS',TO_DATE('25/02/93','dd/mm/yy'),2);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'FERNANDO',TO_DATE('12/07/92','dd/mm/yy'),1);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'ANTONIO',TO_DATE('27/12/81','dd/mm/yy'),3);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'JORGE',TO_DATE('28/11/97','dd/mm/yy'),2);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'GABRIELA',TO_DATE('24/11/97','dd/mm/yy'),4);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'NICOLAS',TO_DATE('16/10/97','dd/mm/yy'),3);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'NATAN',TO_DATE('19/12/97','dd/mm/yy'),2);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'SABRINA',TO_DATE('10/07/97','dd/mm/yy'),1);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'ADRIANO',TO_DATE('12/10/97','dd/mm/yy'),2);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'ALEX',TO_DATE('18/12/97','dd/mm/yy'),3);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'NICOLE',TO_DATE('11/11/97','dd/mm/yy'),3);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'FLAVIA',TO_DATE('12/03/97','dd/mm/yy'),1);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'DEBORA',TO_DATE('08/03/97','dd/mm/yy'),2);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'ANA',TO_DATE('03/11/97','dd/mm/yy'),3);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'VALQUIRIA',TO_DATE('01/10/97','dd/mm/yy'),4);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'DIANA',TO_DATE('27/12/97','dd/mm/yy'),2);
INSERT INTO ALUNOS VALUES(SEQ_RA.NEXTVAL,'ANTONIA',TO_DATE('19/07/97','dd/mm/yy'),1);

INSERT INTO ALUNOS_GRAD VALUES(5,19000001);
INSERT INTO ALUNOS_GRAD VALUES(6,19000002);
INSERT INTO ALUNOS_GRAD VALUES(8,19000003);
INSERT INTO ALUNOS_GRAD VALUES(4,19000004);
INSERT INTO ALUNOS_GRAD VALUES(8,19000005);
INSERT INTO ALUNOS_GRAD VALUES(4,19000006);
INSERT INTO ALUNOS_GRAD VALUES(9,19000007);
INSERT INTO ALUNOS_GRAD VALUES(10,19000008);
INSERT INTO ALUNOS_GRAD VALUES(3,19000009);
INSERT INTO ALUNOS_GRAD VALUES(2,19000010);
INSERT INTO ALUNOS_GRAD VALUES(6,19000011);
INSERT INTO ALUNOS_GRAD VALUES(5,19000012);
INSERT INTO ALUNOS_GRAD VALUES(4,19000013);
INSERT INTO ALUNOS_GRAD VALUES(2,19000014);
INSERT INTO ALUNOS_GRAD VALUES(7,19000015);
INSERT INTO ALUNOS_GRAD VALUES(3,19000016);
INSERT INTO ALUNOS_GRAD VALUES(9,19000017);
INSERT INTO ALUNOS_GRAD VALUES(1,19000018);
INSERT INTO ALUNOS_GRAD VALUES(7,19000019);
INSERT INTO ALUNOS_GRAD VALUES(4,19000020);
INSERT INTO ALUNOS_GRAD VALUES(7,19000021);
INSERT INTO ALUNOS_GRAD VALUES(4,19000022);
INSERT INTO ALUNOS_GRAD VALUES(8,19000023);
INSERT INTO ALUNOS_GRAD VALUES(9,19000024);
INSERT INTO ALUNOS_GRAD VALUES(0,19000025);
INSERT INTO ALUNOS_GRAD VALUES(5,19000026);
INSERT INTO ALUNOS_GRAD VALUES(8,19000027);
INSERT INTO ALUNOS_GRAD VALUES(8,19000028);
INSERT INTO ALUNOS_GRAD VALUES(6,19000029);
INSERT INTO ALUNOS_GRAD VALUES(4,19000030);

INSERT INTO ALUNOS_POS VALUES('EDMAR',19000031);
INSERT INTO ALUNOS_POS VALUES('DANIELE',19000032);
INSERT INTO ALUNOS_POS VALUES('PAULO',19000033);
INSERT INTO ALUNOS_POS VALUES('FRANCISCO',19000034);
INSERT INTO ALUNOS_POS VALUES('GERALDO',19000035);
INSERT INTO ALUNOS_POS VALUES('SANDRA',19000036);
INSERT INTO ALUNOS_POS VALUES('DANIEL',19000037);
INSERT INTO ALUNOS_POS VALUES('RICARDO',19000038);
INSERT INTO ALUNOS_POS VALUES('LEANDRO',19000039);
INSERT INTO ALUNOS_POS VALUES('PATRICIA',19000000);

INSERT INTO CURSAM VALUES(19000001,100,90);
INSERT INTO CURSAM VALUES(19000002,101,90);
INSERT INTO CURSAM VALUES(19000003,102,90);
INSERT INTO CURSAM VALUES(19000004,100,75);
INSERT INTO CURSAM VALUES(19000005,101,80);
INSERT INTO CURSAM VALUES(19000006,102,89);
INSERT INTO CURSAM VALUES(19000007,103,87);
INSERT INTO CURSAM VALUES(19000008,104,98);
INSERT INTO CURSAM VALUES(19000009,105,97);
INSERT INTO CURSAM VALUES(19000010,101,89);
INSERT INTO CURSAM VALUES(19000011,102,70);
INSERT INTO CURSAM VALUES(19000012,120,90);
INSERT INTO CURSAM VALUES(19000013,130,80);
INSERT INTO CURSAM VALUES(19000014,111,78);
INSERT INTO CURSAM VALUES(19000015,120,90);
INSERT INTO CURSAM VALUES(19000016,111,99);
INSERT INTO CURSAM VALUES(19000017,101,78);
INSERT INTO CURSAM VALUES(19000018,103,98);
INSERT INTO CURSAM VALUES(19000019,105,78);
INSERT INTO CURSAM VALUES(19000020,109,98);
INSERT INTO CURSAM VALUES(19000021,118,99);
INSERT INTO CURSAM VALUES(19000022,114,100);
INSERT INTO CURSAM VALUES(19000023,130,98);
INSERT INTO CURSAM VALUES(19000024,109,97);
INSERT INTO CURSAM VALUES(19000025,101,90);
INSERT INTO CURSAM VALUES(19000026,102,98);
INSERT INTO CURSAM VALUES(19000027,100,99);
INSERT INTO CURSAM VALUES(19000028,127,80);
INSERT INTO CURSAM VALUES(19000029,112,98);
INSERT INTO CURSAM VALUES(19000030,103,99);
INSERT INTO CURSAM VALUES(19000031,115,98);
INSERT INTO CURSAM VALUES(19000032,118,98);
INSERT INTO CURSAM VALUES(19000033,112,97);
INSERT INTO CURSAM VALUES(19000034,130,98);
INSERT INTO CURSAM VALUES(19000035,127,99);
INSERT INTO CURSAM VALUES(19000036,124,97);
INSERT INTO CURSAM VALUES(19000037,118,99);
INSERT INTO CURSAM VALUES(19000038,124,97);
INSERT INTO CURSAM VALUES(19000039,125,99);
INSERT INTO CURSAM VALUES(19000040,117,90);
INSERT INTO CURSAM VALUES(19000001,112,97);
INSERT INTO CURSAM VALUES(19000002,117,98);
INSERT INTO CURSAM VALUES(19000003,123,98);
INSERT INTO CURSAM VALUES(19000004,127,98);
INSERT INTO CURSAM VALUES(19000005,121,99);
INSERT INTO CURSAM VALUES(19000006,125,97);
INSERT INTO CURSAM VALUES(19000007,130,98);
INSERT INTO CURSAM VALUES(19000008,112,90);
INSERT INTO CURSAM VALUES(19000009,117,98);
INSERT INTO CURSAM VALUES(19000010,114,97);
INSERT INTO CURSAM VALUES(19000011,118,98);
INSERT INTO CURSAM VALUES(19000012,118,97);
INSERT INTO CURSAM VALUES(19000013,100,99);
INSERT INTO CURSAM VALUES(19000014,100,97);
INSERT INTO CURSAM VALUES(19000015,124,98);
INSERT INTO CURSAM VALUES(19000016,124,99);
INSERT INTO CURSAM VALUES(19000017,123,97);
INSERT INTO CURSAM VALUES(19000018,123,99);
INSERT INTO CURSAM VALUES(19000019,112,90);
INSERT INTO CURSAM VALUES(19000020,100,97);
INSERT INTO CURSAM VALUES(19000021,153,98);
INSERT INTO CURSAM VALUES(19000022,115,99);
INSERT INTO CURSAM VALUES(19000023,120,99);
INSERT INTO CURSAM VALUES(19000024,110,80);
INSERT INTO CURSAM VALUES(19000025,102,97);
INSERT INTO CURSAM VALUES(19000026,120,69);
INSERT INTO CURSAM VALUES(19000027,110,70);
INSERT INTO CURSAM VALUES(19000028,130,90);
INSERT INTO CURSAM VALUES(19000029,125,90);
INSERT INTO CURSAM VALUES(19000030,114,90);
INSERT INTO CURSAM VALUES(19000031,125,90);
INSERT INTO CURSAM VALUES(19000032,115,90);
INSERT INTO CURSAM VALUES(19000033,117,90);
INSERT INTO CURSAM VALUES(19000034,112,90);
INSERT INTO CURSAM VALUES(19000035,125,90);
INSERT INTO CURSAM VALUES(19000036,124,90);
INSERT INTO CURSAM VALUES(19000037,118,90);
INSERT INTO CURSAM VALUES(19000038,118,90);
INSERT INTO CURSAM VALUES(19000039,114,90);
INSERT INTO CURSAM VALUES(19000040,119,90);


INSERT INTO CURSARAM VALUES(19000001,100,'0117',4,90,'R');
INSERT INTO CURSARAM VALUES(19000002,101,'0117',3,90,'R');
INSERT INTO CURSARAM VALUES(19000003,102,'0118',3,90,'R');
INSERT INTO CURSARAM VALUES(19000004,100,'0117',2,75,'R');
INSERT INTO CURSARAM VALUES(19000005,101,'0217',6,80,'A');
INSERT INTO CURSARAM VALUES(19000006,102,'0217',5,89,'A');
INSERT INTO CURSARAM VALUES(19000007,103,'0216',7,87,'A');
INSERT INTO CURSARAM VALUES(19000008,104,'0216',5,98,'A');
INSERT INTO CURSARAM VALUES(19000009,105,'0216',7,97,'A');
INSERT INTO CURSARAM VALUES(19000010,101,'0316',6,89,'A');
INSERT INTO CURSARAM VALUES(19000011,102,'0316',6,70,'R');
INSERT INTO CURSARAM VALUES(19000012,120,'0316',5,90,'A');
INSERT INTO CURSARAM VALUES(19000013,130,'0415',7,80,'A');
INSERT INTO CURSARAM VALUES(19000014,111,'0415',4,78,'R');
INSERT INTO CURSARAM VALUES(19000015,120,'0415',6,90,'A');
INSERT INTO CURSARAM VALUES(19000016,111,'0515',8,99,'A');
INSERT INTO CURSARAM VALUES(19000017,101,'0515',5,78,'A');
INSERT INTO CURSARAM VALUES(19000018,103,'0517',5,98,'A');
INSERT INTO CURSARAM VALUES(19000019,105,'0616',4,78,'R');
INSERT INTO CURSARAM VALUES(19000020,109,'0616',6,98,'A');
INSERT INTO CURSARAM VALUES(19000021,118,'0616',7,99,'A');
INSERT INTO CURSARAM VALUES(19000022,114,'0716',7,100,'A');
INSERT INTO CURSARAM VALUES(19000023,130,'0713',4,98,'R');
INSERT INTO CURSARAM VALUES(19000024,109,'0716',5,97,'A');
INSERT INTO CURSARAM VALUES(19000025,101,'0817',3,90,'R');
INSERT INTO CURSARAM VALUES(19000026,102,'0817',6,98,'A');
INSERT INTO CURSARAM VALUES(19000027,100,'0817',5,99,'A');
INSERT INTO CURSARAM VALUES(19000028,127,'0917',4,80,'R');
INSERT INTO CURSARAM VALUES(19000029,112,'0917',6,98,'A');
INSERT INTO CURSARAM VALUES(19000030,103,'0916',7,99,'A');
INSERT INTO CURSARAM VALUES(19000031,115,'1016',3,98,'R');
INSERT INTO CURSARAM VALUES(19000032,118,'1015',5,98,'A');
INSERT INTO CURSARAM VALUES(19000033,112,'1014',5,97,'A');
INSERT INTO CURSARAM VALUES(19000034,130,'0514',7,98,'A');
INSERT INTO CURSARAM VALUES(19000035,127,'0417',8,99,'A');
INSERT INTO CURSARAM VALUES(19000036,124,'0517',9,97,'A');
INSERT INTO CURSARAM VALUES(19000037,118,'0617',7,99,'A');
INSERT INTO CURSARAM VALUES(19000038,124,'0717',6,97,'A');
INSERT INTO CURSARAM VALUES(19000039,125,'0816',5,99,'A');
INSERT INTO CURSARAM VALUES(19000040,117,'0914',5,90,'A');
INSERT INTO CURSARAM VALUES(19000001,112,'0917',4,97,'R');
INSERT INTO CURSARAM VALUES(19000002,117,'0917',6,98,'A');
INSERT INTO CURSARAM VALUES(19000003,123,'1018',7,98,'A');
INSERT INTO CURSARAM VALUES(19000004,127,'1017',7,98,'A');
INSERT INTO CURSARAM VALUES(19000005,121,'1018',4,99,'R');
INSERT INTO CURSARAM VALUES(19000006,125,'0618',6,97,'A');
INSERT INTO CURSARAM VALUES(19000007,130,'0717',4,98,'R');
INSERT INTO CURSARAM VALUES(19000008,112,'0516',7,90,'A');
INSERT INTO CURSARAM VALUES(19000009,117,'0715',3,98,'R');
INSERT INTO CURSARAM VALUES(19000010,114,'0314',6,97,'A');
INSERT INTO CURSARAM VALUES(19000011,118,'0216',7,98,'A');
INSERT INTO CURSARAM VALUES(19000012,118,'0417',3,97,'R');
INSERT INTO CURSARAM VALUES(19000013,100,'0417',7,99,'A');
INSERT INTO CURSARAM VALUES(19000014,100,'0416',3,97,'R');
INSERT INTO CURSARAM VALUES(19000015,124,'0515',7,98,'A');
INSERT INTO CURSARAM VALUES(19000016,124,'0515',2,99,'R');
INSERT INTO CURSARAM VALUES(19000017,123,'0715',7,97,'A');
INSERT INTO CURSARAM VALUES(19000018,123,'0716',5,99,'A');
INSERT INTO CURSARAM VALUES(19000019,112,'0717',7,90,'A');
INSERT INTO CURSARAM VALUES(19000020,100,'0516',5,97,'A');
INSERT INTO CURSARAM VALUES(19000021,153,'0518',7,98,'A');
INSERT INTO CURSARAM VALUES(19000022,115,'0316',4,99,'R');
INSERT INTO CURSARAM VALUES(19000023,120,'0518',5,99,'A');
INSERT INTO CURSARAM VALUES(19000024,110,'0617',8,80,'A');
INSERT INTO CURSARAM VALUES(19000025,102,'0718',6,97,'A');
INSERT INTO CURSARAM VALUES(19000026,120,'0518',5,69,'A');
INSERT INTO CURSARAM VALUES(19000027,110,'0315',5,70,'R');
INSERT INTO CURSARAM VALUES(19000028,130,'0214',6,90,'A');
INSERT INTO CURSARAM VALUES(19000029,125,'0616',4,90,'R');
INSERT INTO CURSARAM VALUES(19000030,114,'0614',7,90,'A');
INSERT INTO CURSARAM VALUES(19000031,125,'0516',3,90,'R');
INSERT INTO CURSARAM VALUES(19000032,115,'0315',7,90,'A');
INSERT INTO CURSARAM VALUES(19000033,117,'0518',3,90,'R');
INSERT INTO CURSARAM VALUES(19000034,112,'0613',7,90,'A');
INSERT INTO CURSARAM VALUES(19000035,125,'0715',7,90,'A');
INSERT INTO CURSARAM VALUES(19000036,124,'0214',5,90,'A');
INSERT INTO CURSARAM VALUES(19000037,118,'0212',7,90,'A');
INSERT INTO CURSARAM VALUES(19000038,118,'0515',3,90,'R');
INSERT INTO CURSARAM VALUES(19000039,114,'0216',4,90,'R');
INSERT INTO CURSARAM VALUES(19000040,119,'0615',5,90,'A');


--CODIGOS EM PL-SQL PARA MANIPULAÃ‡ÃƒO DO BANCO DE DADOS
--TERMINADO
CREATE OR REPLACE PROCEDURE HIST_ALUNO(REGISTRO NUMBER) IS
TMP_NOME VARCHAR2(20);
TMP_DATA_NASC DATE;
TMP_N_CURSO NUMBER;
TMP_CURSO VARCHAR2(30);
TMP_CD NUMBER;
TMP_ORIENTADOR VARCHAR2(30);
BEGIN
	SELECT NOME,DATA_NASC,NUM_CURSO INTO TMP_NOME,TMP_DATA_NASC,TMP_N_CURSO FROM ALUNOS WHERE RA=REGISTRO;
	SELECT NOME INTO TMP_CURSO FROM CURSOS WHERE NUM=TMP_N_CURSO;
	
	BEGIN
	SELECT CD INTO TMP_CD FROM ALUNOS_GRAD WHERE RA=REGISTRO;
	EXCEPTION WHEN NO_DATA_FOUND THEN NULL; 
	END;
	
	BEGIN
	SELECT ORIENTADOR INTO TMP_ORIENTADOR FROM ALUNOS_POS WHERE RA=REGISTRO;
	EXCEPTION WHEN NO_DATA_FOUND THEN NULL;
	END;
		
	
	DBMS_OUTPUT.PUT_LINE(chr(13)||chr(10)||'NOME= '||TMP_NOME);
	DBMS_OUTPUT.PUT_LINE('NASCIMENTO= '||TMP_DATA_NASC);
	DBMS_OUTPUT.PUT_LINE('CURSO= '||TMP_CURSO);
	DBMS_OUTPUT.PUT_LINE('ORIENTADOR= '||TMP_ORIENTADOR);
	DBMS_OUTPUT.PUT_LINE('CD= '||TMP_CD);
	
	DBMS_OUTPUT.PUT_LINE('-------------------'||chr(13)||chr(10));
	DBMS_OUTPUT.PUT_LINE('CURSANDO'||chr(13)||chr(10));
	FOR i IN (SELECT * FROM CURSAM WHERE RA=REGISTRO)
	LOOP 
	DBMS_OUTPUT.PUT_LINE(i.COD_DISC);
	END LOOP;
	
	
	DBMS_OUTPUT.PUT_LINE(chr(13)||chr(10)||'CURSADAS'||chr(13)||chr(10));
	FOR j IN (SELECT * FROM CURSARAM WHERE RA=REGISTRO)
	LOOP 
	DBMS_OUTPUT.PUT_LINE(j.COD_DISC);
	END LOOP;

	DBMS_OUTPUT.PUT_LINE(chr(13)||chr(10)||'FALTA CURSAR'||chr(13)||chr(10));
	
	FOR k IN (SELECT DISTINCT COD_DISC FROM GRADE WHERE NUM_CURSO = (SELECT NUM_CURSO FROM ALUNOS WHERE RA=REGISTRO) MINUS SELECT COD_DISC FROM CURSARAM WHERE RA=REGISTRO AND STATUS = 'A' MINUS SELECT COD_DISC FROM CURSAM WHERE RA=REGISTRO)
	LOOP
	DBMS_OUTPUT.PUT_LINE(k.COD_DISC);
	END LOOP;
	
END;
/

--PERTENCER AO CURSO CUJA GRADE TENHA ESSA DISCIPLINA
--PREENCHER TODOS OS PRE-REQUISITOS
--TERMINADO
CREATE OR REPLACE FUNCTION VERIFICA(REGISTRO NUMBER,CODIGO NUMBER) RETURN VARCHAR2 IS
VALUER NUMBER;
BEGIN
VALUER:=0;
FOR I IN (SELECT * FROM GRADE WHERE NUM_CURSO = (SELECT NUM_CURSO FROM ALUNOS WHERE RA=REGISTRO))
LOOP

	IF I.COD_DISC = CODIGO THEN
		FOR J IN (SELECT * FROM PRE_REQ WHERE COD_DISC = CODIGO)
		LOOP
			BEGIN
				SELECT COD_PRE_REQ INTO VALUER FROM PRE_REQ WHERE COD_DISC = CODIGO MINUS SELECT COD_DISC FROM CURSARAM WHERE RA=REGISTRO AND STATUS='A';
				EXCEPTION WHEN NO_DATA_FOUND THEN 
					RETURN 'APTO';
				RAISE;	
			END;
		
		END LOOP;
		
		IF VALUER = 0 THEN
			RETURN 'APTO';
		ELSE
			RETURN 'NAO APTO';
		END IF;

	END IF;

END LOOP;

RETURN 'NAO APTO';
END;
/




--VERIFICAR SE O ALUNO ESTA APTO A CURSAR A DISCIPLINA USANDO A FUNCTION VERIFICA
CREATE OR REPLACE TRIGGER VERIFICA_APTIDAO 
BEFORE INSERT ON CURSAM
FOR EACH ROW
DECLARE A VARCHAR2(10);
BEGIN 
	SELECT VERIFICA(:NEW.RA,:NEW.COD_DISC) INTO A FROM DUAL;
	
	 IF A = 'NAO APTO' THEN
			:NEW.RA := NULL;
			EXCEPTION WHEN OTHERS THEN NULL;
			
		END IF; 
	
		DBMS_OUTPUT.PUT_LINE('TRIGGER ATIVADA');
END;
/

INSERT INTO CURSAM VALUES(19000000,104,90);
DELETE FROM CURSAM WHERE RA=19000000;
SELECT VERIFICA(19000000,104) FROM DUAL;

--REMOVER O ALUNO DE CURSAM APOS INSERT EM CURSADAS
CREATE OR REPLACE TRIGGER FORMANDO AFTER INSERT ON CURSARAM 
FOR EACH ROW
BEGIN 

 DELETE FROM CURSAM WHERE RA=:NEW.RA AND COD_DISC=:NEW.COD_DISC;

END;
/

--ATUALIZA O CD
CREATE OR REPLACE TRIGGER ATT_CD AFTER INSERT ON CURSARAM 
FOR EACH ROW
BEGIN

UPDATE ALUNOS_GRAD SET CD=(CD+:NEW.NOTA)/2 WHERE RA=:NEW.RA;

END;
/

